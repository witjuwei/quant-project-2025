"""
é‚¢ä¸è¡Œï½œç­–ç•¥åˆ†äº«ä¼š
é€‰å¸ç­–ç•¥æ¡†æ¶ğ“Ÿğ“»ğ“¸

ç‰ˆæƒæ‰€æœ‰ Â©ï¸ é‚¢ä¸è¡Œ
å¾®ä¿¡: xbx1717

æœ¬ä»£ç ä»…ä¾›ä¸ªäººå­¦ä¹ ä½¿ç”¨ï¼Œæœªç»æˆæƒä¸å¾—å¤åˆ¶ã€ä¿®æ”¹æˆ–ç”¨äºå•†ä¸šç”¨é€”ã€‚

Author: é‚¢ä¸è¡Œ

# ** å› å­æ–‡ä»¶åŠŸèƒ½è¯´æ˜ **
1. å› å­åº“ä¸­çš„æ¯ä¸ª Python æ–‡ä»¶éœ€å®ç° `signal` å‡½æ•°ï¼Œç”¨äºè®¡ç®—å› å­å€¼ã€‚
2. é™¤ `signal` å¤–ï¼Œå¯æ ¹æ®éœ€æ±‚æ·»åŠ è¾…åŠ©å‡½æ•°ï¼Œä¸å½±å“å› å­è®¡ç®—é€»è¾‘ã€‚

# ** signal å‡½æ•°å‚æ•°ä¸è¿”å›å€¼è¯´æ˜ **
1. `signal` å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º `candle_df`ï¼Œç”¨äºæ¥æ”¶å•ä¸ªå¸ç§çš„ K çº¿æ•°æ®ã€‚
2. `signal` å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ç”¨äºå› å­è®¡ç®—çš„ä¸»è¦å‚æ•°ï¼Œå…·ä½“ç”¨æ³•è§å‡½æ•°å®ç°ã€‚
3. `signal` å‡½æ•°å¯ä»¥æ¥æ”¶å…¶ä»–å¯é€‰å‚æ•°ï¼ŒæŒ‰å®é™…å› å­è®¡ç®—é€»è¾‘ä½¿ç”¨ã€‚
4. `signal` å‡½æ•°çš„è¿”å›å€¼åº”ä¸ºåŒ…å«å› å­æ•°æ®çš„ K çº¿æ•°æ®ã€‚

# ** candle_df ç¤ºä¾‹ **
    candle_begin_time         symbol      open      high       low     close       volume  quote_volume  trade_num  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  funding_fee   first_candle_time  æ˜¯å¦äº¤æ˜“
0          2023-11-22  1000BONK-USDT  0.004780  0.004825  0.004076  0.004531  12700997933  5.636783e+07     320715                   6184933232                  2.746734e+07     0.001012 2023-11-22 14:00:00         1
1          2023-11-23  1000BONK-USDT  0.004531  0.004858  0.003930  0.004267  18971334686  8.158966e+07     573386                   8898242083                  3.831782e+07     0.001634 2023-11-22 14:00:00         1
2          2023-11-24  1000BONK-USDT  0.004267  0.004335  0.003835  0.004140  17168511399  6.992947e+07     475254                   7940993618                  3.239266e+07     0.005917 2023-11-22 14:00:00         1
æ³¨æ„ï¼šè‹¥ä¸ºå°æ—¶çº§åˆ«ç­–ç•¥ï¼Œ`candle_begin_time` æ ¼å¼ä¸º 2023-11-22 14:00:00ï¼›è‹¥ä¸ºæ—¥çº¿ï¼Œåˆ™ä¸º 2023-11-22ã€‚

# ** signal å‚æ•°ç¤ºä¾‹ **
- å¦‚æœç­–ç•¥é…ç½®ä¸­ `factor_list` åŒ…å« ('QuoteVolumeMean', True, 7, 1)ï¼Œåˆ™ `param` ä¸º 7ï¼Œ`args[0]` ä¸º 'QuoteVolumeMean_7'ã€‚
- å¦‚æœç­–ç•¥é…ç½®ä¸­ `filter_list` åŒ…å« ('QuoteVolumeMean', 7, 'pct:<0.8')ï¼Œåˆ™ `param` ä¸º 7ï¼Œ`args[0]` ä¸º 'QuoteVolumeMean_7'ã€‚
"""


def signal(*args):
    df = args[0]
    n = args[1]
    factor_name = args[2]

    df[factor_name] = df['close'].pct_change(n)

    return df


def signal_multi_params(df, param_list) -> dict:
    """
    ä½¿ç”¨åŒå› å­å¤šå‚æ•°èšåˆè®¡ç®—ï¼Œå¯ä»¥æœ‰æ•ˆæå‡å›æµ‹ã€å®ç›˜ cal_factor çš„é€Ÿåº¦ï¼Œ
    ç›¸å¯¹äº `signal` å¤§æ¦‚æå‡3å€å·¦å³
    :param df: kçº¿æ•°æ®çš„dataframe
    :param param_list: å‚æ•°åˆ—è¡¨
    """
    ret = dict()
    for param in param_list:
        n = int(param)
        ret[str(param)] = df['close'].pct_change(n)
    return ret
